# Add an index column to each DataFrame
df1 = df1.withColumn("index", F.monotonically_increasing_id())
df2 = df2.withColumn("index", F.monotonically_increasing_id())
df3 = df3.withColumn("index", F.monotonically_increasing_id())

# Join the DataFrames on the index column
result_df = df1.join(df2, on="index", how="outer") \
               .join(df3, on="index", how="outer") \
               .drop("index")  # Drop the index column if not needed

# Show the result
result_df.show()
