
# Initialize CatBoostRegressor
catboost_train = CatBoostRegressor(n_estimators=12,
                                loss_function='RMSE',
                                learning_rate=0.02,
                                depth=8, 
                                task_type='CPU',
                                random_state=1,
                                verbose=False)

# Timing the fitting process
t0 = time.time()

# Fit the model
catboost_train.fit(train_X, train_y, cat_features=cat_features)

# Make predictions
preds_val = catboost_train.predict(val_X)

# val_y = val_data_target.toPandas()

# Calculate RMSE
rmse_val_s = np.sqrt(np.mean((val_y.values - preds_val) ** 2))

# Print results
print(f"Total pred lis: {sum(preds_val)} and Actual total lis (duns with nonzero lines): {val_y.sum()[0]}")
print(f'RMSE: {rmse_val_s}')
